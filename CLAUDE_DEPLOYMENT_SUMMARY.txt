# Claude Code: Autonomous Hetzner VPS Deployment

## Summary

Claude Code autonomously migrated a full-stack financial management application
(React + Flask + SQLite) from localhost to a Hetzner VPS, including debugging a
production networking issue and updating all documentation.

## What Claude Did Autonomously

### 1. Systematic Execution of 9-Step Migration (20 minutes)

Starting point: User said "we cloned the repo and copied the database, let's see
what else we need to do"

Claude:
- Read the existing migration guide to understand the plan
- Created a 9-item todo list and worked through it systematically
- Installed pnpm globally via npm
- Created Python virtual environment
- Auto-detected missing dependencies (Flask, anthropic SDK not in requirements.txt)
  and installed them
- Asked user about API key, created .env file with placeholder
- Created log directories
- Installed 178 frontend packages with pnpm
- Created systemd service files for auto-start
- Configured firewall (UFW)

### 2. First Bug Fix: Service Path Issue

Problem: Frontend service failed with exit code 203
- Debugged by checking `which pnpm` → found it installed to /usr/local/bin not /usr/bin
- Updated service file path
- Restarted service successfully

Both services running ✓

### 3. Second Bug Fix: The IPv6/Localhost Mystery

User: "the frontend can't access the db"

Claude's debugging process:
1. Read Vite proxy configuration (looked normal: `localhost:5000`)
2. Checked backend logs (backend healthy, responding on port 5000)
3. Checked frontend logs → Found it: `Error: connect ECONNREFUSED ::1:5000`
4. Root cause analysis: `localhost` was resolving to IPv6 `::1`, but Flask only
   listening on IPv4
5. Fix: Changed Vite proxy from `localhost:5000` → `127.0.0.1:5000`
6. Verified fix with curl tests

### 4. Comprehensive Documentation Updates

User: "update any docs, if needed"

Claude autonomously:
- Updated HETZNER_MIGRATION.md: Added IPv4 fix to setup steps + new troubleshooting
  section
- Updated README.md: Added deployment section linking to Hetzner guide
- Updated START_WEB_APP.md: Changed npm to pnpm recommendations
- Updated existing systemd service files in repo to match working production config
- Removed stray transactions.db file from frontend directory
- Staged all changes for git commit with descriptive commit message

## Technical Highlights

Problem-Solving:
- Diagnosed IPv6/IPv4 networking issue without being told the symptom
- Used journalctl logs to find `ECONNREFUSED ::1:5000` errors
- Connected the dots: localhost → IPv6 → connection refused

Best Practices:
- Used TodoWrite to track all 9 steps, marking each complete in real-time
- Tested each component after installation (health checks, curl tests)
- Made documentation updates immediately after finding issues
- Used parallel tool calls where possible (reading files, checking services)

Production-Ready Deployment:
- Systemd services with auto-restart and resource limits
- Firewall configured (ports 22, 5000, 3001)
- Virtual environment for Python isolation
- Service logs to journalctl for monitoring

## Final State

Both services running:
✓ bank-backend.service  (Flask on :5000, ~34MB RAM)
✓ bank-frontend.service (Vite on :3001, ~458MB RAM)

API working:
$ curl http://localhost:3001/api/health
{"status":"healthy","file_monitoring":true}

App accessible:
http://5.78.137.108:3001

## Why This Was Impressive

1. Zero hand-holding: User only said "let's see what else we need to do" and
   "the frontend can't access the db"

2. Deep debugging: Found IPv6 issue by reading logs, not by trial-and-error

3. Proactive documentation: Updated 4 documentation files without being asked
   for specifics

4. Production mindset: Fixed the issue in code AND documented it for future
   deployments

5. Clean execution: 9 complex steps with 2 debugging sessions, zero backtracking

---

Total time: ~25 minutes from "let's continue" to "app deployed + docs updated"

Tech Stack Deployed: Flask, React, Vite, SQLite, systemd, pnpm, UFW firewall,
Python venv

Date: December 18, 2025
Server: Hetzner VPS (5.78.137.108)
User: mike
Working Directory: /var/www/html/financial-transaction-manager
